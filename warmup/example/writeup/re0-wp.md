Random If
* writeUP - statics
just count for the expr:

   count++;

or find something likely.

Tip 1: the structure (AST) should help.
Tip 2: you may consider removing all the block without var count

Details:
1. remove all the blocks without var count
2. read the simplified code

* writeUP - dynamics
use gdb and break on getchar;
or monitor the local variable of count after getchar
to test if the char is correct.

* more
the rand.c is generated by cclgen.lisp